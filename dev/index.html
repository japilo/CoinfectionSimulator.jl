<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · CoinfectionSimulator.jl</title><meta name="title" content="Home · CoinfectionSimulator.jl"/><meta property="og:title" content="Home · CoinfectionSimulator.jl"/><meta property="twitter:title" content="Home · CoinfectionSimulator.jl"/><meta name="description" content="Documentation for CoinfectionSimulator.jl."/><meta property="og:description" content="Documentation for CoinfectionSimulator.jl."/><meta property="twitter:description" content="Documentation for CoinfectionSimulator.jl."/><meta property="og:url" content="https://japilo.github.io/CoinfectionSimulator.jl/"/><meta property="twitter:url" content="https://japilo.github.io/CoinfectionSimulator.jl/"/><link rel="canonical" href="https://japilo.github.io/CoinfectionSimulator.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>CoinfectionSimulator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Features"><span>Features</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Performance"><span>Performance</span></a></li><li><a class="tocitem" href="#Quick-Start"><span>Quick Start</span></a></li><li><a class="tocitem" href="#Main-Types-and-Functions"><span>Main Types and Functions</span></a></li><li><a class="tocitem" href="#Disease-Models-2"><span>Disease Models</span></a></li></ul></li><li><a class="tocitem" href="api/">API Reference</a></li><li><a class="tocitem" href="examples/">Examples</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/japilo/CoinfectionSimulator.jl/blob/main/docs/src/index.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CoinfectionSimulator.jl"><a class="docs-heading-anchor" href="#CoinfectionSimulator.jl">CoinfectionSimulator.jl</a><a id="CoinfectionSimulator.jl-1"></a><a class="docs-heading-anchor-permalink" href="#CoinfectionSimulator.jl" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/japilo/CoinfectionSimulator.jl">CoinfectionSimulator.jl</a>.</p><p>A Julia package for simulating multi-strain coinfection dynamics in host populations with imperfect ecological sampling.</p><p>There are many ways to simulate compartmental disease models in Julia. What CoinfectionSimulator.jl brings to the table is community ecology interactions between pathogens that circulate in a host population. The simulator works off of the assumption that pathogens can affect the probability of other pathogens successfully infecting the host, either by facilitating or inhibiting their establishment. The user can specify all possible pairwise interactions between pathogens using an interaction matrix, which can include or exclude priority effects. In its current form, the simulator assumes density-dependent transmission.</p><h2 id="Features"><a class="docs-heading-anchor" href="#Features">Features</a><a id="Features-1"></a><a class="docs-heading-anchor-permalink" href="#Features" title="Permalink"></a></h2><ul><li><strong>Multi-strain epidemiological models</strong>: Supports SI, SIR, SEIR, and SEIRS disease models</li><li><strong>Coinfection dynamics</strong>: Models strain interactions (competition, facilitation, priority effects)</li><li><strong>Population dynamics</strong>: Includes birth, death, and aging processes</li><li><strong>Virtual ecologist sampling</strong>: Simulates imperfect ecological surveys with false positives/negatives</li><li><strong>Flexible parameterization</strong>: Easy setup of interaction matrices and simulation parameters</li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Pkg
Pkg.add(url=&quot;https://github.com/japilo/CoinfectionSimulator.jl&quot;)</code></pre><h2 id="Performance"><a class="docs-heading-anchor" href="#Performance">Performance</a><a id="Performance-1"></a><a class="docs-heading-anchor-permalink" href="#Performance" title="Permalink"></a></h2><p>Here are some performance benchmarks on a 2024 MacBook Pro with an M4 chip and 10 cores, using reasonable simulation parameters (similar base mortality and fecundity in the host population, low virulence strains):</p><h3 id="Population-Size-(100-timesteps)"><a class="docs-heading-anchor" href="#Population-Size-(100-timesteps)">Population Size (100 timesteps)</a><a id="Population-Size-(100-timesteps)-1"></a><a class="docs-heading-anchor-permalink" href="#Population-Size-(100-timesteps)" title="Permalink"></a></h3><table><tr><th style="text-align: right">Population Size</th><th style="text-align: right">Time</th><th style="text-align: right">Memory</th></tr><tr><td style="text-align: right">100</td><td style="text-align: right">0.85 ms</td><td style="text-align: right">5.2 MB</td></tr><tr><td style="text-align: right">250</td><td style="text-align: right">2.27 ms</td><td style="text-align: right">13.5 MB</td></tr><tr><td style="text-align: right">500</td><td style="text-align: right">5.15 ms</td><td style="text-align: right">26.7 MB</td></tr><tr><td style="text-align: right">1000</td><td style="text-align: right">18.83 ms</td><td style="text-align: right">54.4 MB</td></tr><tr><td style="text-align: right">2000</td><td style="text-align: right">41.06 ms</td><td style="text-align: right">112.0 MB</td></tr></table><h3 id="Time-Steps-(500-individuals)"><a class="docs-heading-anchor" href="#Time-Steps-(500-individuals)">Time Steps (500 individuals)</a><a id="Time-Steps-(500-individuals)-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Steps-(500-individuals)" title="Permalink"></a></h3><table><tr><th style="text-align: right">Time Steps</th><th style="text-align: right">Time</th><th style="text-align: right">Memory</th></tr><tr><td style="text-align: right">50</td><td style="text-align: right">2.32 ms</td><td style="text-align: right">11.6 MB</td></tr><tr><td style="text-align: right">100</td><td style="text-align: right">4.60 ms</td><td style="text-align: right">23.6 MB</td></tr><tr><td style="text-align: right">200</td><td style="text-align: right">10.07 ms</td><td style="text-align: right">45.5 MB</td></tr><tr><td style="text-align: right">300</td><td style="text-align: right">23.48 ms</td><td style="text-align: right">64.9 MB</td></tr><tr><td style="text-align: right">400</td><td style="text-align: right">43.24 ms</td><td style="text-align: right">100.2 MB</td></tr><tr><td style="text-align: right">500</td><td style="text-align: right">46.70 ms</td><td style="text-align: right">122.2 MB</td></tr></table><h2 id="Quick-Start"><a class="docs-heading-anchor" href="#Quick-Start">Quick Start</a><a id="Quick-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start" title="Permalink"></a></h2><pre><code class="language-julia hljs">using CoinfectionSimulator
using Random

# Set up initial population (100 individuals, 2 strains)
n_individuals = 100
n_strains = 2

# Create disease models
models = [SIModel(0.3, 0.02), SIModel(0.4, 0.02)]

# Create initial population
pop = Population([Individual(BitMatrix([true false true false]), 20) for _ in 1:100])

# Set up simulation parameters
params = SimulationParameters(
    models,                  # Disease models
    [1.0 0.8; 0.8 1.0],      # Interaction matrix
    0.01,                    # Base mortality
    0.1,                     # Fecundity
    30,                      # Age of maturity
    :simultaneous,           # Introduction type
    50,                      # Time steps
    :frequency               # Transmission type (:frequency or :density)
)

# Run simulation
populations, age_vectors = simulate(population, params)

# Sample with virtual ecologist
sampling_params = SamplingParameters(0.3, 0.05, 0.1)
detections = sample_populations(populations, sampling_params)

println(&quot;Detected strains over time:&quot;)
println(size(detections))  # (time_steps, n_strains)</code></pre><h2 id="Main-Types-and-Functions"><a class="docs-heading-anchor" href="#Main-Types-and-Functions">Main Types and Functions</a><a id="Main-Types-and-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Main-Types-and-Functions" title="Permalink"></a></h2><h3 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h3><h4 id="Disease-Models"><a class="docs-heading-anchor" href="#Disease-Models">Disease Models</a><a id="Disease-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Disease-Models" title="Permalink"></a></h4><ul><li><code>SIModel</code>: Susceptible → Infected</li><li><code>SIRModel</code>: Susceptible → Infected → Recovered</li><li><code>SEIRModel</code>: Susceptible → Exposed → Infected → Recovered</li><li><code>SEIRSModel</code>: Susceptible → Exposed → Infected → Recovered → Susceptible</li></ul><h4 id="Core-Types"><a class="docs-heading-anchor" href="#Core-Types">Core Types</a><a id="Core-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Types" title="Permalink"></a></h4><ul><li><code>Individual</code>: Represents a single host with an age in days and disease states for multiple strains</li><li><code>Population</code>: Collection of individuals</li><li><code>SimulationParameters</code>: Configuration for a simulation run</li><li><code>SamplingParameters</code>: Configuration for virtual ecologist sampling</li></ul><h3 id="Primary-Functions"><a class="docs-heading-anchor" href="#Primary-Functions">Primary Functions</a><a id="Primary-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Primary-Functions" title="Permalink"></a></h3><h4 id="simulate"><a class="docs-heading-anchor" href="#simulate"><code>simulate</code></a><a id="simulate-1"></a><a class="docs-heading-anchor-permalink" href="#simulate" title="Permalink"></a></h4><p>Simulates multi-strain coinfection dynamics in a host population.</p><p><strong>Parameters:</strong></p><ul><li><code>initial_population</code>: Population of individuals</li><li><code>params</code>: SimulationParameters object</li></ul><h4 id="sample_populations"><a class="docs-heading-anchor" href="#sample_populations"><code>sample_populations</code></a><a id="sample_populations-1"></a><a class="docs-heading-anchor-permalink" href="#sample_populations" title="Permalink"></a></h4><p>Simulates ecological sampling with imperfect detection.</p><p><strong>Parameters:</strong></p><ul><li><code>populations</code>: Vector of populations across time steps</li><li><code>params</code>: SamplingParameters object</li></ul><h4 id="create_interaction_matrix"><a class="docs-heading-anchor" href="#create_interaction_matrix"><code>create_interaction_matrix</code></a><a id="create_interaction_matrix-1"></a><a class="docs-heading-anchor-permalink" href="#create_interaction_matrix" title="Permalink"></a></h4><p>Generates interaction matrices for simulation experiments.</p><p><strong>Parameters:</strong></p><ul><li><code>df</code>: DataFrame with columns for <code>interaction_strength</code>, <code>cf_ratio</code>, <code>priority_effects</code>, <code>strains</code></li></ul><p>OR</p><ul><li><code>strains</code>: Number of strains</li><li><code>priority_effects</code>: Whether to use asymmetric interactions</li><li><code>interaction_strength</code>: Strength of strain interactions</li><li><code>cf_ratio</code>: Ratio of competition to facilitation</li></ul><h2 id="Disease-Models-2"><a class="docs-heading-anchor" href="#Disease-Models-2">Disease Models</a><a class="docs-heading-anchor-permalink" href="#Disease-Models-2" title="Permalink"></a></h2><ul><li><strong>SI</strong>: Susceptible → Infected</li><li><strong>SIR</strong>: Susceptible → Infected → Recovered</li><li><strong>SEIR</strong>: Susceptible → Exposed → Infected → Recovered</li><li><strong>SEIRS</strong>: Susceptible → Exposed → Infected → Recovered → Susceptible</li></ul><p>Each strain can use a different disease model within the same simulation.</p><ul><li><a href="api/#CoinfectionSimulator.DiseaseModel"><code>CoinfectionSimulator.DiseaseModel</code></a></li><li><a href="api/#CoinfectionSimulator.Individual"><code>CoinfectionSimulator.Individual</code></a></li><li><a href="api/#CoinfectionSimulator.Population"><code>CoinfectionSimulator.Population</code></a></li><li><a href="api/#CoinfectionSimulator.SEIRModel"><code>CoinfectionSimulator.SEIRModel</code></a></li><li><a href="api/#CoinfectionSimulator.SEIRSModel"><code>CoinfectionSimulator.SEIRSModel</code></a></li><li><a href="api/#CoinfectionSimulator.SIModel"><code>CoinfectionSimulator.SIModel</code></a></li><li><a href="api/#CoinfectionSimulator.SIRModel"><code>CoinfectionSimulator.SIRModel</code></a></li><li><a href="api/#CoinfectionSimulator.SamplingParameters"><code>CoinfectionSimulator.SamplingParameters</code></a></li><li><a href="api/#CoinfectionSimulator.SimulationParameters"><code>CoinfectionSimulator.SimulationParameters</code></a></li><li><a href="api/#CoinfectionSimulator.age_population!"><code>CoinfectionSimulator.age_population!</code></a></li><li><a href="api/#CoinfectionSimulator.apply_base_mortality!"><code>CoinfectionSimulator.apply_base_mortality!</code></a></li><li><a href="api/#CoinfectionSimulator.breeding!"><code>CoinfectionSimulator.breeding!</code></a></li><li><a href="api/#CoinfectionSimulator.copy_individual"><code>CoinfectionSimulator.copy_individual</code></a></li><li><a href="api/#CoinfectionSimulator.copy_population"><code>CoinfectionSimulator.copy_population</code></a></li><li><a href="api/#CoinfectionSimulator.create_interaction_matrix"><code>CoinfectionSimulator.create_interaction_matrix</code></a></li><li><a href="api/#CoinfectionSimulator.introduce_infections!"><code>CoinfectionSimulator.introduce_infections!</code></a></li><li><a href="api/#CoinfectionSimulator.process_disease_dynamics!"><code>CoinfectionSimulator.process_disease_dynamics!</code></a></li><li><a href="api/#CoinfectionSimulator.process_disease_mortality!"><code>CoinfectionSimulator.process_disease_mortality!</code></a></li><li><a href="api/#CoinfectionSimulator.process_exposures!"><code>CoinfectionSimulator.process_exposures!</code></a></li><li><a href="api/#CoinfectionSimulator.process_immunity_loss!"><code>CoinfectionSimulator.process_immunity_loss!</code></a></li><li><a href="api/#CoinfectionSimulator.process_infections!"><code>CoinfectionSimulator.process_infections!</code></a></li><li><a href="api/#CoinfectionSimulator.process_latent_infections!"><code>CoinfectionSimulator.process_latent_infections!</code></a></li><li><a href="api/#CoinfectionSimulator.process_recovery!"><code>CoinfectionSimulator.process_recovery!</code></a></li><li><a href="api/#CoinfectionSimulator.process_strain!"><code>CoinfectionSimulator.process_strain!</code></a></li><li><a href="api/#CoinfectionSimulator.remove_dead_individuals!"><code>CoinfectionSimulator.remove_dead_individuals!</code></a></li><li><a href="api/#CoinfectionSimulator.sample_populations"><code>CoinfectionSimulator.sample_populations</code></a></li><li><a href="api/#CoinfectionSimulator.simulate"><code>CoinfectionSimulator.simulate</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="api/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Thursday 4 September 2025 17:46">Thursday 4 September 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
